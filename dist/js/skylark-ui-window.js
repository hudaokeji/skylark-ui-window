/**
 * skylark-ui-window - The skylark window widget
 * @author Hudaokeji, Inc.
 * @version v0.9.0
 * @link https://github.com/skylarkui/skylark-ui-window/
 * @license MIT
 */
!function(t,e){function i(t,e){if("."!==t[0])return t;var i=e.split("/"),n=t.split("/");i.pop();for(var o=0;o<n.length;o++)"."!=n[o]&&(".."==n[o]?i.pop():i.push(n[o]));return i.join("/")}var n=e.define,o=e.require,s="function"==typeof n&&n.amd,a=!s&&"undefined"!=typeof exports;if(!s&&!n){var r={};n=e.define=function(t,e,n){"function"==typeof n?(r[t]={factory:n,deps:e.map(function(e){return i(e,t)}),exports:null},o(t)):resolved[t]=n},o=e.require=function(t){if(!r.hasOwnProperty(t))throw new Error("Module "+t+" has not been defined");var e=r[t];if(!e.exports){var i=[];e.deps.forEach(function(t){i.push(o(t))}),e.exports=e.factory.apply(window,i)}return e.exports}}t(n,o),s||(a?exports=o("skylark-ui-repeater/main"):e.skylarkjs||(e.skylarkjs=o("skylark-langx/skylark")))}(function(t,e){t("skylark-utils-interact/interact",["skylark-utils/skylark","skylark-utils/langx"],function(t,e){var i=t.interact={};return i}),t("skylark-utils-interact/mover",["./interact","skylark-utils/langx","skylark-utils/noder","skylark-utils/datax","skylark-utils/geom","skylark-utils/eventer","skylark-utils/styler"],function(t,e,i,n,o,s,a){function r(t,e,n,s){var a=i.ownerDoc(t),r=i.ownerWindow(a),l=o.size(r);l.left=0,l.top=0,t.parentNode&&"body"==String(t.parentNode.tagName).toLowerCase()||a.body.appendChild(t);var d=null;return w.apply(e,function(e){var i=e.corner,a=e.pos,r=0,h={w:{L:l.left+l.width-a.x,R:a.x-l.left,M:l.width}[i.charAt(1)],h:{T:l.top+l.height-a.y,B:a.y-l.top,M:l.height}[i.charAt(0)]};if(n){var c=n(t,e.aroundCorner,i,h,s);r="undefined"==typeof c?0:c}var w=o.size(t),u={L:a.x,R:a.x-w.width,M:Math.max(l.left,Math.min(l.left+l.width,a.x+(w.width>>1))-w.width)}[i.charAt(1)],f={T:a.y,B:a.y-w.height,M:Math.max(l.top,Math.min(l.top+l.height,a.y+(w.height>>1))-w.height)}[i.charAt(0)],p=Math.max(l.left,u),m=Math.max(l.top,f),g=Math.min(l.left+l.width,u+w.width),y=Math.min(l.top+l.height,f+w.height),b=g-p,v=y-m;return r+=w.width-b+(w.height-v),(null==d||r<d.overflow)&&(d={corner:i,aroundCorner:e.aroundCorner,left:p,top:m,width:b,height:v,overflow:r,spaceAvailable:h}),!r}),d.overflow&&n&&n(t,d.aroundCorner,d.corner,d.spaceAvailable,s),o.boundingPosition(t,d),d}function l(t,e,i,n,o){var s=u.apply(i,function(t){var i={corner:t,aroundCorner:reverse[t],pos:{x:e.x,y:e.y}};return n&&(i.pos.x+="L"==t.charAt(1)?n.x:-n.x,i.pos.y+="T"==t.charAt(0)?n.y:-n.y),i});return r(t,s,o)}function d(t,e,i,n,o){function s(t,e){$.push({aroundCorner:t,corner:e,pos:{x:{L:y,R:y+v,M:y+(v>>1)}[t.charAt(1)],y:{T:b,B:b+k,M:b+(k>>1)}[t.charAt(0)]}})}var a;if("string"==typeof e||"offsetWidth"in e||"ownerSVGElement"in e){if(a=domGeometry.position(e,!0),/^(above|below)/.test(i[0])){var l=domGeometry.getBorderExtents(e),d=e.firstChild?domGeometry.getBorderExtents(e.firstChild):{t:0,l:0,b:0,r:0},h=domGeometry.getBorderExtents(t),c=t.firstChild?domGeometry.getBorderExtents(t.firstChild):{t:0,l:0,b:0,r:0};a.y+=Math.min(l.t+d.t,h.t+c.t),a.h-=Math.min(l.t+d.t,h.t+c.t)+Math.min(l.b+d.b,h.b+c.b)}}else a=e;if(e.parentNode)for(var w="absolute"==domStyle.getComputedStyle(e).position,u=e.parentNode;u&&1==u.nodeType&&"BODY"!=u.nodeName;){var f=domGeometry.position(u,!0),p=domStyle.getComputedStyle(u);if(/relative|absolute/.test(p.position)&&(w=!1),!w&&/hidden|auto|scroll/.test(p.overflow)){var m=Math.min(a.y+a.h,f.y+f.h),g=Math.min(a.x+a.w,f.x+f.w);a.x=Math.max(a.x,f.x),a.y=Math.max(a.y,f.y),a.h=m-a.y,a.w=g-a.x}"absolute"==p.position&&(w=!0),u=u.parentNode}var y=a.x,b=a.y,v="w"in a?a.w:a.w=a.width,k="h"in a?a.h:(kernel.deprecated("place.around: dijit/place.__Rectangle: { x:"+y+", y:"+b+", height:"+a.height+", width:"+v+" } has been deprecated.  Please use { x:"+y+", y:"+b+", h:"+a.height+", w:"+v+" }","","2.0"),a.h=a.height),$=[];array.forEach(i,function(t){var e=n;switch(t){case"above-centered":s("TM","BM");break;case"below-centered":s("BM","TM");break;case"after-centered":e=!e;case"before-centered":s(e?"ML":"MR",e?"MR":"ML");break;case"after":e=!e;case"before":s(e?"TL":"TR",e?"TR":"TL"),s(e?"BL":"BR",e?"BR":"BL");break;case"below-alt":e=!e;case"below":s(e?"BL":"BR",e?"TL":"TR"),s(e?"BR":"BL",e?"TR":"TL");break;case"above-alt":e=!e;case"above":s(e?"TL":"TR",e?"BL":"BR"),s(e?"TR":"TL",e?"BR":"BL");break;default:s(t.aroundCorner,t.corner)}});var x=r(t,$,o,{w:v,h:k});return x.aroundNodePos=a,x}function h(t,e){function n(t){var e,i;if(t.changedTouches)for(e="screenX screenY pageX pageY clientX clientY".split(" "),i=0;i<e.length;i++)t[e[i]]=t.changedTouches[0][e[i]]}e=e||{};var r,l,d,h,c,w,u,f,p=e.handle||t,m=e.auto!==!1,g=e.constraints,y=e.document||document,b=e.started,v=e.moving,k=e.stopped,d=function(e){var d,m=o.getDocumentSize(y);n(e),e.preventDefault(),l=e.button,c=e.screenX,w=e.screenY,u=o.relativePosition(t),f=o.size(t),d=a.css(p,"curosr"),r=i.createElement("div"),a.css(r,{position:"absolute",top:0,left:0,width:m.width,height:m.height,zIndex:2147483647,opacity:1e-4,cursor:d}),i.append(y.body,r),s.on(y,"mousemove touchmove",$).on(y,"mouseup touchend",h),b&&b(e)},$=function(e){if(n(e),0!==e.button)return h(e);if(e.deltaX=e.screenX-c,e.deltaY=e.screenY-w,m){var i=u.left+e.deltaX,s=u.top+e.deltaY;g&&(i<g.minX&&(i=g.minX),i>g.maxX&&(i=g.maxX),s<g.minY&&(s=g.minY),s>g.maxY&&(s=g.maxY))}o.relativePosition(t,{left:i,top:s}),e.preventDefault(),v&&v(e)},h=function(t){n(t),s.off(y,"mousemove touchmove",$).off(y,"mouseup touchend",h),i.remove(r),k&&k(t)};return s.on(p,"mousedown touchstart",d),{remove:function(){s.off(p)}}}function c(){return c}var w=(s.on,s.off,n.attr,n.removeAttr,o.pagePosition,a.addClass,o.height,Array.prototype.some),u=Array.prototype.map;return e.mixin(c,{around:d,at:l,movable:h}),t.mover=c}),t("skylark-ui-swt/sbswt",["skylark-utils/skylark","skylark-utils/langx","skylark-utils/browser","skylark-utils/eventer","skylark-utils/noder","skylark-utils/geom","skylark-utils/query","skylark-utils/widgets"],function(t,e,i,n,o,s,a,r){var l=t.ui=t.ui||{},d=l.sbswt={},h={BACKSPACE_KEYCODE:8,COMMA_KEYCODE:188,DELETE_KEYCODE:46,DOWN_ARROW_KEYCODE:40,ENTER_KEYCODE:13,TAB_KEYCODE:9,UP_ARROW_KEYCODE:38},c=function(t){return t.shiftKey===!0},w=function(t){return function(e){return e.keyCode===t}},u=w(h.BACKSPACE_KEYCODE),f=w(h.DELETE_KEYCODE),p=w(h.TAB_KEYCODE),m=w(h.UP_ARROW_KEYCODE),g=w(h.DOWN_ARROW_KEYCODE),y=/&[^\s]*;/,b=function(t){for(;y.test(t);)t=a("<i>").html(t).text();return a("<i>").text(t).html()};e.mixin(d,{CONST:h,cleanInput:b,isBackspaceKey:u,isDeleteKey:f,isShiftHeld:c,isTabKey:p,isUpArrow:m,isDownArrow:g});var v=r.Widget.inherit({klassName:"WidgetBase"});return e.mixin(d,{WidgetBase:v}),d}),t("skylark-ui-window/window",["skylark-utils/langx","skylark-utils/browser","skylark-utils/datax","skylark-utils/eventer","skylark-utils/noder","skylark-utils/geom","skylark-utils/velm","skylark-utils/query","skylark-utils-interact/mover","skylark-ui-swt/sbswt"],function(t,e,i,n,o,s,a,r,l,d){var h="bsw",c=d.Window=d.WidgetBase.inherit({klassName:"Window",init:function(e,i){i=i||{};var n={selectors:{handle:".window-header",title:".window-title",body:".window-body",footer:".window-footer"},elements:{handle:null,title:null,body:null,footer:null},references:{body:r("body"),window:r(window)},effect:"fade",parseHandleForTitle:!0,maximized:!1,maximizable:!1,title:"No Title",bodyContent:"",footerContent:""};i=this.options=t.mixin({},n,i,!0);var o=this;return this.$el=r(e),this.$el.hasClass("window")||this.$el.addClass("window"),this.$el.data("window",this),this.$el.find(i.selectors.handle).length<=0&&this.$el.prepend('<div class="window-header"><h4 class="window-title"></h4></div>'),i.elements.handle=this.$el.find(i.selectors.handle),i.elements.title=this.$el.find(i.selectors.title),i.elements.body=this.$el.find(i.selectors.body),i.elements.footer=this.$el.find(i.selectors.footer),i.elements.title.html(i.title),i.maximizable&&(i.elements.buttons={},i.elements.buttons.maximize=r('<button data-maximize="window"><i class="glyphicon glyphicon-chevron-up"></i></button>'),i.elements.handle.prepend(i.elements.buttons.maximize),i.elements.buttons.restore=r('<button data-restore="window"><i class="glyphicon glyphicon-modal-window"></i></button>'),i.elements.handle.prepend(i.elements.buttons.restore)),o.$el.find("[data-dismiss=window]").length<=0&&i.elements.handle.prepend('<button type="button" class="close" data-dismiss="window" aria-hidden="true"><i class="glyphicon glyphicon-remove"></i></button>'),i.elements.body.html(i.bodyContent),i.elements.footer.html(i.footerContent),this.undock(),this.setSticky(i.sticky),this},undock:function(){var t=this;this.$el.css("visibility","hidden"),this.$el.appendTo("body"),this.centerWindow(),/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)&&this.options.references.window.bind("orientationchange resize",function(e){t.centerWindow()}),this.$el.on("touchmove",function(t){t.stopPropagation()}),this.initHandlers(),this.$el.hide(),this.options.id?this.id=this.options.id:this.id="",this.show()},maximize:function(){this.$el.removeClass("minimized"),this.$el.addClass("maximized"),this.state="maximized";var t=0;this.options.window_manager&&(t=this.options.window_manager.getContainer().height()),this.$el.css({top:parseInt(r("body").css("padding-top"),10),left:0,right:0,bottom:t,maxWidth:"none",width:"auto",height:"auto"}),this.$el.trigger(h+".maximize")},restore:function(){this.$el.removeClass("minimized"),this.$el.removeClass("maximized"),this.$el.removeAttr("style"),this.state=void 0,this.$el.css({top:this.window_info.top,left:this.window_info.left,width:this.window_info.width,height:this.window_info.height}),this.$el.removeProp("style"),this.$el.trigger(h+".restore")},show:function(t){var e=this;this.$el.css("visibility","visible");var i=function(){e.$el.trigger(h+".show"),t&&t.call(e,arguments)};"fade"===this.options.effect?this.$el.fadeIn(void 0,void 0,i):i.call(this.$el)},setEffect:function(t){this.options.effect=t},getEffect:function(){return this.options.effect},centerWindow:function(){var t,e,i,n=parseInt(this.options.references.body.position().top,10)+parseInt(this.options.references.body.css("paddingTop"),10);this.options.sticky?(e=this.options.references.window.width()/2-this.$el.width()/2,t=this.options.references.window.height()/2-this.$el.height()/2):(e=this.options.references.window.width()/2-this.$el.width()/2,t=this.options.references.window.height()/2-this.$el.height()/2),t<n&&(t=n),i=this.options.references.window.height()-n-(parseInt(this.options.elements.handle.css("height"),10)+parseInt(this.options.elements.footer.css("height"),10))-45,this.options.elements.body.css("maxHeight",i),this.$el.css("left",e),this.$el.css("top",t),this.$el&&this.$el.length>0&&(this.window_info={top:this.$el.position().top,left:this.$el.position().left,width:this.$el.outerWidth(),height:this.$el.outerHeight()}),this.$el.trigger(h+".centerWindow")},close:function(t){var e=this;this.options.parent?(this.options.parent.clearBlocker(),this.options.window_manager&&this.options.window_manager.setFocused(this.options.parent)):this.options.window_manager&&this.options.window_manager.windows.length>0&&this.options.window_manager.setNextFocused();var i=function(){e.$el.trigger(h+".close"),e.$el.remove(),t&&t.call(e)};"fade"===this.options.effect?this.$el.fadeOut(i):i.call(e.$el),this.$windowTab&&("fade"===this.options.effect?this.$windowTab.fadeOut(400,function(){e.$windowTab.remove()}):(this.$windowTab.hide(),this.$windowTab.remove()))},on:function(){this.$el.on.apply(this.$el,arguments)},sendToBack:function(){var t=!1;return this.options.window_manager&&(t=this.options.window_manager.sendToBack(this)),t},setActive:function(t){t?(this.$el.addClass("active"),this.$windowTab&&this.$windowTab.addClass("label-primary"),this.$el.trigger("active")):(this.$el.removeClass("active"),this.$windowTab&&(this.$windowTab.removeClass("label-primary"),this.$windowTab.addClass("label-default")),this.$el.trigger("inactive"))},setIndex:function(t){this.$el.css("zIndex",t)},setWindowTab:function(t){this.$windowTab=t},getWindowTab:function(){return this.$windowTab},getTitle:function(){return this.options.title},getElement:function(){return this.$el},setSticky:function(t){this.options.sticky=t,t===!1?this.$el.css({position:"absolute"}):this.$el.css({position:"fixed"})},getSticky:function(){return this.options.sticky},setManager:function(t){this.options.window_manager=t},initHandlers:function(){var t=this;this.$el.find("[data-dismiss=window]").on("click",function(e){e.stopPropagation(),e.preventDefault(),t.options.blocker||t.close()}),this.$el.find("[data-maximize=window]").on("click",function(e){e.stopPropagation(),e.preventDefault(),t.options.blocker||t.maximize()}),this.$el.find("[data-restore=window]").on("click",function(e){t.options.blocker||t.restore()}),this.moveable=l.movable(this.$el[0],{handle:this.options.elements.title[0]})},resize:function(t){t=t||{},t.top&&this.$el.css("top",t.top),t.left&&this.$el.css("left",t.left),t.height&&this.$el.css("height",t.height),t.width&&this.$el.css("width",t.width),this.$el.trigger(h+".resize")},setBlocker:function(t){this.options.blocker=t,this.$el.find(".disable-shade").remove();var e='<div class="disable-shade"></div>';this.options.elements.body.append(e),this.options.elements.body.addClass("disable-scroll"),this.options.elements.footer.append(e),"fade"===this.options.effect?this.$el.find(".disable-shade").fadeIn():this.$el.find(".disable-shade").show(),this.options.blocker.getParent()||this.options.blocker.setParent(this)},getBlocker:function(){return this.options.blocker},clearBlocker:function(){this.options.elements.body.removeClass("disable-scroll"),"fade"===this.options.effect?this.$el.find(".disable-shade").fadeOut(function(){this.remove()}):(this.$el.find(".disable-shade").hide(),this.remove()),delete this.options.blocker},setParent:function(t){this.options.parent=t,this.options.parent.getBlocker()||this.options.parent.setBlocker(this)},getParent:function(){return this.options.parent},blink:function(){var t=this,e=this.$el.hasClass("active"),i=this.getWindowTab(),n=i?i.hasClass("label-primary"):void 0,o=setInterval(function(){t.$el.toggleClass("active"),i&&i.toggleClass("label-primary")},250);setTimeout(function(){clearInterval(o),e&&t.$el.addClass("active"),i&&n&&i.addClass("label-primary")},1e3)}});i.window=function(t,e){var i=this.data(t,"sbswt.window");i||this.data(t,"sbswt.window",i=new c(t)),"string"==typeof option&&i[e]()},r.fn.window=function(t){return this.each(function(){i.window(this,t)})},a.partial("window",function(t){i.window(this.domNode,t)}),r("[data-window-target]").off("click"),r("[data-window-target]").on("click",function(){var t=r(this),e={selectors:{}};t.data("windowTitle")&&(e.title=t.data("windowTitle")),t.data("titleHandle")&&(e.selectors.title=t.data("titleHandle")),t.data("windowHandle")&&(e.selectors.handle=t.data("windowHandle")),t.data("clone")&&(e.clone=t.data("windowHandle")),r(t.data("windowTarget")).window(e)});var w=d.WindowManager=d.WidgetBase.inherit({klassName:"WindowManager",init:function(t){return this.windows=[],t=t||{},this.initialize(t),this},findWindowByID:function(e){var i=null;return t.each(this.windows,function(t,n){console.log(arguments),n.id===e&&(i=n)}),i},destroyWindow:function(e){var i=this,n=!1;return t.each(this.windows,function(t,o){o===e&&(e.close(),i.windows.splice(t,1),i.resortWindows(),n=!0)}),n},closeWindow:function(t){this.destroyWindow(t)},resortWindows:function(){var e=900;t.each(this.windows,function(t,i){i.setIndex(e+t)})},setFocused:function(e){for(var i;e.getBlocker();)e=e.getBlocker();t.each(this.windows,function(t,n){n.setActive(!1),n===e&&(i=t)}),this.windows.push(this.windows.splice(i,1)[0]),e.setActive(!0),this.resortWindows()},sendToBack:function(t){var e=this.windows.splice(this.windows.indexOf(t),1)[0];return this.windows.unshift(e),this.resortWindows(),!0},initialize:function(t){this.options=t,this.elements={},this.options.container&&(this.elements.container=r(this.options.container),this.elements.container.addClass("window-pane"))},getContainer:function(){var t;return this.elements&&this.elements.container&&(t=this.elements.container),t},setNextFocused:function(){this.setFocused(this.windows[this.windows.length-1])},addWindow:function(t){var e=this;return t.getElement().on("focused",function(i){e.setFocused(t)}),t.getElement().on("close",function(){e.destroyWindow(t),t.getWindowTab()&&t.getWindowTab().remove()}),t.on("bsw.restore",function(){e.resortWindows()}),this.options.container&&(t.setWindowTab(r('<span class="label label-default">'+t.getTitle()+'<button class="close">x</button></span>')),t.getWindowTab().find(".close").on("click",function(e){var i=t.getBlocker();i?i.blink():t.close()}),t.getWindowTab().on("click",function(i){var n=t.getBlocker();n?n.blink():(e.setFocused(t),t.getSticky()&&window.scrollTo(0,t.getElement().position().top))}),r(this.options.container).append(t.getWindowTab())),this.windows.push(t),t.setManager(this),this.setFocused(t),t},createWindow:function(e){var i=t.mixin({},e);this.options.windowTemplate&&!i.template&&(i.template=this.options.windowTemplate);var n=new c(i.template,i);return this.addWindow(n)}});return t.mixin(d,{Window:c,WindowManager:w}),r.fn.window}),t("skylark-ui-window/main",["skylark-utils/query","./window"],function(t){return t}),t("skylark-ui-window",["skylark-ui-window/main"],function(t){return t})},this);
//# sourceMappingURL=sourcemaps/skylark-ui-window.js.map

{"version":3,"sources":["Window.js"],"names":["define","skylark","langx","browser","datax","eventer","noder","geom","velm","$","plugins","Movable","windows","Window","Plugin","inherit","klassName","pluginName","options","selectors","handle","title","body","footer","elements","references","window","effect","parseHandleForTitle","maximized","maximizable","bodyContent","footerContent","_construct","elm","this","overrided","$el","hasClass","addClass","data","find","length","prepend","html","buttons","maximize","restore","undock","setSticky","sticky","_this","css","appendTo","centerWindow","test","navigator","userAgent","bind","event","on","e","stopPropagation","initHandlers","hide","id","show","removeClass","state","bottomOffset","window_manager","getContainer","height","top","parseInt","left","right","bottom","maxWidth","width","trigger","namespace","removeAttr","undefined","window_info","removeProp","cb","callbackHandler","call","arguments","fadeIn","setEffect","getEffect","maxHeight","bodyTop","position","outerWidth","outerHeight","close","parent","clearBlocker","setFocused","setNextFocused","closeFn","remove","fadeOut","$windowTab","apply","sendToBack","returnVal","setActive","active","setIndex","index","setWindowTab","windowTab","getWindowTab","getTitle","getElement","getSticky","setManager","preventDefault","blocker","moveable","resize","setBlocker","window_handle","shade","append","getParent","setParent","getBlocker","blink","focused","blinkInterval","setInterval","toggleClass","setTimeout","clearInterval","wgt","option","off","$this","opts","clone","register"],"mappings":"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","file":"../Window.js","sourcesContent":["define([\r\n  \"skylark-langx/skylark\",\r\n  \"skylark-langx/langx\",\r\n  \"skylark-domx-browser\",\r\n  \"skylark-domx-data\",\r\n  \"skylark-domx-eventer\",\r\n  \"skylark-domx-noder\",\r\n  \"skylark-domx-geom\",\r\n  \"skylark-domx-velm\",\r\n  \"skylark-domx-query\",\r\n  \"skylark-domx-plugins\",  \r\n  \"skylark-domx-interact/Movable\",\r\n  \"./windows\",  \r\n],function(skylark,langx,browser,datax,eventer,noder,geom,velm,$,plugins,Movable,windows){\r\n\r\n\r\n    var namespace = 'bsw';\r\n\r\n\r\n    var Window = plugins.Plugin.inherit({\r\n        klassName : \"Window\",\r\n\r\n        pluginName : \"domx.window\",\r\n\r\n        options : {\r\n            selectors: {\r\n                handle: '.window-header',\r\n                title: '.window-title',\r\n                body: '.window-body',\r\n                footer: '.window-footer'\r\n            },\r\n            elements: {\r\n                handle: null,\r\n                title: null,\r\n                body: null,\r\n                footer: null\r\n            },\r\n            references: {\r\n                body: $('body'),\r\n                window: $(window)\r\n            },\r\n            effect: 'fade',\r\n            parseHandleForTitle: true,\r\n            maximized: false,\r\n            maximizable: false,\r\n            title: 'No Title',\r\n            bodyContent: '',\r\n            footerContent: ''\r\n        },\r\n\r\n        _construct : function(elm,options) {\r\n            this.overrided(elm,options);\r\n\r\n            options = this.options;\r\n\r\n            var _this = this;\r\n\r\n            this.$el = this.$();\r\n\r\n            if (!this.$el.hasClass('window')) {\r\n                this.$el.addClass('window');\r\n            }\r\n            this.$el.data('window', this);\r\n\r\n            if (this.$el.find(options.selectors.handle).length <= 0) {\r\n                this.$el.prepend('<div class=\"window-header\"><h4 class=\"window-title\"></h4></div>');\r\n            }\r\n\r\n\r\n            options.elements.handle = this.$el.find(options.selectors.handle);\r\n            options.elements.title = this.$el.find(options.selectors.title);\r\n            options.elements.body = this.$el.find(options.selectors.body);\r\n            options.elements.footer = this.$el.find(options.selectors.footer);\r\n            options.elements.title.html(options.title);\r\n\r\n            if (options.maximizable) {\r\n                options.elements.buttons = {};\r\n                options.elements.buttons.maximize = $('<button data-maximize=\"window\"><i class=\"glyphicon glyphicon-chevron-up\"></i></button>');\r\n                options.elements.handle.prepend(options.elements.buttons.maximize);\r\n                options.elements.buttons.restore = $('<button data-restore=\"window\"><i class=\"glyphicon glyphicon-modal-window\"></i></button>');\r\n                options.elements.handle.prepend(options.elements.buttons.restore);\r\n\r\n            }\r\n            if (_this.$el.find('[data-dismiss=window]').length <= 0) {\r\n                options.elements.handle.prepend('<button type=\"button\" class=\"close\" data-dismiss=\"window\" aria-hidden=\"true\"><i class=\"glyphicon glyphicon-remove\"></i></button>');\r\n            }\r\n            options.elements.body.html(options.bodyContent);\r\n            options.elements.footer.html(options.footerContent);\r\n\r\n            this.undock();\r\n\r\n            this.setSticky(options.sticky);\r\n\r\n            return this;\r\n        },\r\n\r\n        undock : function() {\r\n            var _this = this;\r\n            this.$el.css('visibility', 'hidden');\r\n            this.$el.appendTo('body');\r\n            this.centerWindow();\r\n            if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)) {\r\n                this.options.references.window.bind('orientationchange resize', function(event) {\r\n                    _this.centerWindow();\r\n                });\r\n            }\r\n\r\n            this.$el.on('touchmove', function(e) {\r\n                e.stopPropagation();\r\n            });\r\n\r\n            this.initHandlers();\r\n            this.$el.hide();\r\n            if (this.options.id) {\r\n                this.id = this.options.id;\r\n            } else {\r\n                this.id = '';\r\n            }\r\n            this.show();\r\n        },\r\n\r\n        maximize : function() {\r\n            this.$el.removeClass('minimized');\r\n            this.$el.addClass('maximized');\r\n            this.state = \"maximized\";\r\n            var bottomOffset = 0;\r\n            if (this.options.window_manager) {\r\n                bottomOffset = this.options.window_manager.getContainer().height();\r\n            }\r\n            this.$el.css({\r\n                top: parseInt($('body').css('padding-top'), 10),\r\n                left: 0,\r\n                right: 0,\r\n                bottom: bottomOffset,\r\n                maxWidth: 'none',\r\n                width: 'auto',\r\n                height: 'auto'\r\n            });\r\n            this.$el.trigger(namespace + '.maximize');\r\n        },\r\n\r\n\r\n        restore : function() {\r\n            this.$el.removeClass('minimized');\r\n            this.$el.removeClass('maximized');\r\n            this.$el.removeAttr('style');\r\n            this.state = undefined;\r\n            this.$el.css({\r\n                top: this.window_info.top,\r\n                left: this.window_info.left,\r\n                width: this.window_info.width,\r\n                height: this.window_info.height\r\n            });\r\n            this.$el.removeProp('style');\r\n            this.$el.trigger(namespace + '.restore');\r\n        },\r\n\r\n        show : function(cb) {\r\n            var _this = this;\r\n            this.$el.css('visibility', 'visible');\r\n            var callbackHandler = function() {\r\n                _this.$el.trigger(namespace + '.show');\r\n                if (cb) {\r\n                    cb.call(_this, arguments);\r\n                }\r\n            };\r\n            if (this.options.effect === 'fade') {\r\n                this.$el.fadeIn(undefined, undefined, callbackHandler);\r\n            } else {\r\n                callbackHandler.call(this.$el);\r\n            }\r\n        },\r\n\r\n        setEffect : function(effect) {\r\n            this.options.effect = effect;\r\n        },\r\n\r\n        getEffect : function() {\r\n            return this.options.effect;\r\n        },\r\n\r\n        centerWindow : function() {\r\n            var top, left,\r\n                bodyTop = parseInt(this.options.references.body.position().top, 10) + parseInt(this.options.references.body.css('paddingTop'), 10),\r\n                maxHeight;\r\n            if (!this.options.sticky) {\r\n                left = (this.options.references.window.width() / 2) - (this.$el.width() / 2);\r\n                top = (this.options.references.window.height() / 2) - (this.$el.height() / 2);\r\n            } else {\r\n                left = (this.options.references.window.width() / 2) - (this.$el.width() / 2);\r\n                top = (this.options.references.window.height() / 2) - (this.$el.height() / 2);\r\n            }\r\n\r\n            if (top < bodyTop) {\r\n                top = bodyTop;\r\n            }\r\n            maxHeight = ((this.options.references.window.height() - bodyTop) - (parseInt(this.options.elements.handle.css('height'), 10) + parseInt(this.options.elements.footer.css('height'), 10))) - 45;\r\n            this.options.elements.body.css('maxHeight', maxHeight);\r\n\r\n            this.$el.css('left', left);\r\n            this.$el.css('top', top);\r\n            if (this.$el && this.$el.length > 0) {\r\n                this.window_info = {\r\n                    top: this.$el.position().top,\r\n                    left: this.$el.position().left,\r\n                    width: this.$el.outerWidth(),\r\n                    height: this.$el.outerHeight()\r\n                };\r\n            }\r\n            this.$el.trigger(namespace + '.centerWindow');\r\n        },\r\n\r\n        close : function(cb) {\r\n            var _this = this;\r\n            if (this.options.parent) {\r\n                this.options.parent.clearBlocker();\r\n                if (this.options.window_manager) {\r\n                    this.options.window_manager.setFocused(this.options.parent);\r\n                }\r\n            } else if (this.options.window_manager && this.options.window_manager.windows.length > 0) {\r\n                this.options.window_manager.setNextFocused();\r\n            }\r\n\r\n            var closeFn = function() {\r\n                _this.$el.trigger(namespace + '.close');\r\n                _this.$el.remove();\r\n                if (cb) {\r\n                    cb.call(_this);\r\n                }\r\n            };\r\n\r\n            if (this.options.effect === 'fade') {\r\n                this.$el.fadeOut(closeFn);\r\n            } else {\r\n                closeFn.call(_this.$el);\r\n            }\r\n\r\n            if (this.$windowTab) {\r\n                if (this.options.effect === 'fade') {\r\n                    this.$windowTab.fadeOut(400, function() {\r\n                        _this.$windowTab.remove();\r\n                    });\r\n                } else {\r\n                    this.$windowTab.hide();\r\n                    this.$windowTab.remove();\r\n                }\r\n\r\n            }\r\n        },\r\n\r\n        on : function() {\r\n            this.$el.on.apply(this.$el, arguments);\r\n        },\r\n\r\n        sendToBack : function () {\r\n            var returnVal = false;\r\n            if (this.options.window_manager) {\r\n                returnVal = this.options.window_manager.sendToBack(this);\r\n            }\r\n            return returnVal;\r\n        },\r\n\r\n        setActive : function(active) {\r\n            if (active) {\r\n                this.$el.addClass('active');\r\n                if (this.$windowTab) {\r\n                    this.$windowTab.addClass('label-primary');\r\n                }\r\n                this.$el.trigger('active');\r\n            } else {\r\n                this.$el.removeClass('active');\r\n                if (this.$windowTab) {\r\n                    this.$windowTab.removeClass('label-primary');\r\n                    this.$windowTab.addClass('label-default');\r\n                }\r\n                this.$el.trigger('inactive');\r\n            }\r\n        },\r\n\r\n        setIndex : function(index) {\r\n            this.$el.css('zIndex', index);\r\n        },\r\n\r\n        setWindowTab : function(windowTab) {\r\n            this.$windowTab = windowTab;\r\n        },\r\n\r\n        getWindowTab : function() {\r\n            return this.$windowTab;\r\n        },\r\n\r\n        getTitle : function() {\r\n            return this.options.title;\r\n        },\r\n\r\n        getElement : function() {\r\n            return this.$el;\r\n        },\r\n\r\n        setSticky : function(sticky) {\r\n            this.options.sticky = sticky;\r\n            if (sticky === false) {\r\n                this.$el.css({\r\n                    'position': 'absolute'\r\n                });\r\n            } else {\r\n                this.$el.css({\r\n                    'position': 'fixed'\r\n                });\r\n            }\r\n        },\r\n\r\n        getSticky : function() {\r\n            return this.options.sticky;\r\n        },\r\n\r\n        setManager : function(window_manager) {\r\n            this.options.window_manager = window_manager;\r\n        },\r\n\r\n        initHandlers : function() {\r\n            var _this = this;\r\n            var title_buttons;\r\n\r\n            this.$el.find('[data-dismiss=window]').on('click', function(event) {\r\n                event.stopPropagation();\r\n                event.preventDefault();\r\n                if (_this.options.blocker) {\r\n                    return;\r\n                }\r\n                _this.close();\r\n            });\r\n\r\n            this.$el.find('[data-maximize=window]').on('click', function(event) {\r\n                event.stopPropagation();\r\n                event.preventDefault();\r\n                if (_this.options.blocker) {\r\n                    return;\r\n                }\r\n                _this.maximize();\r\n            });\r\n\r\n            this.$el.find('[data-restore=window]').on('click', function(event) {\r\n                if (_this.options.blocker) {\r\n                    return;\r\n                }\r\n                _this.restore();\r\n            });\r\n\r\n            this.moveable = new Movable(this.$el[0],{\r\n                handle : this.options.elements.title[0]\r\n            });\r\n\r\n            /*\r\n\r\n \r\n            this.$el.off('mousedown');\r\n            this.$el.on('mousedown', function() {\r\n                if (_this.options.blocker) {\r\n                    _this.options.blocker.getElement().trigger('focused');\r\n                    _this.options.blocker.blink();\r\n                    return;\r\n                } else {\r\n                    _this.$el.trigger('focused');\r\n                }\r\n\r\n                if (_this.$el.hasClass('ns-resize') || _this.$el.hasClass('ew-resize')) {\r\n                    $('body > *').addClass('disable-select');\r\n                    _this.resizing = true;\r\n                    _this.offset = {};\r\n                    _this.offset.x = event.pageX;\r\n                    _this.offset.y = event.pageY;\r\n                    _this.window_info = {\r\n                        top: _this.$el.position().top,\r\n                        left: _this.$el.position().left,\r\n                        width: _this.$el.outerWidth(),\r\n                        height: _this.$el.outerHeight()\r\n                    };\r\n\r\n                    if (event.offsetY < 5) {\r\n                        _this.$el.addClass('north');\r\n                    }\r\n                    if (event.offsetY > (_this.$el.height() - 5)) {\r\n                        _this.$el.addClass('south');\r\n                    }\r\n                    if (event.offsetX < 5) {\r\n                        _this.$el.addClass('west');\r\n                    }\r\n                    if (event.offsetX > (_this.$el.width() - 5)) {\r\n                        _this.$el.addClass('east');\r\n                    }\r\n                }\r\n            });\r\n\r\n\r\n            _this.options.references.body.on('mouseup', function() {\r\n                _this.resizing = false;\r\n                $('body > *').removeClass('disable-select');\r\n                _this.$el.removeClass('west');\r\n                _this.$el.removeClass('east');\r\n                _this.$el.removeClass('north');\r\n                _this.$el.removeClass('south');\r\n\r\n            });\r\n            _this.options.elements.handle.off('mousedown');\r\n            _this.options.elements.handle.on('mousedown', function(event) {\r\n                if (_this.options.blocker) {\r\n                    return;\r\n                }\r\n                _this.moving = true;\r\n                _this.offset = {};\r\n                _this.offset.x = event.pageX - _this.$el.position().left;\r\n                _this.offset.y = event.pageY - _this.$el.position().top;\r\n                $('body > *').addClass('disable-select');\r\n            });\r\n            _this.options.elements.handle.on('mouseup', function(event) {\r\n                _this.moving = false;\r\n                $('body > *').removeClass('disable-select');\r\n            });\r\n\r\n\r\n            _this.options.references.body.on('mousemove', _this.$el, function(event) {\r\n                if (_this.moving && _this.state !== \"maximized\" &&\r\n                    (\r\n                        $(event.toElement).hasClass(_this.options.selectors.handle.replace('.', '')) ||\r\n                        $(event.toElement).hasClass(_this.options.selectors.title.replace('.', ''))\r\n                    )) {\r\n\r\n\r\n                    var top = _this.options.elements.handle.position().top,\r\n                        left = _this.options.elements.handle.position().left;\r\n                    _this.$el.css('top', event.pageY - _this.offset.y);\r\n                    _this.window_info.top = event.pageY - _this.offset.y;\r\n                    _this.$el.css('left', event.pageX - _this.offset.x);\r\n                    _this.window_info.left = event.pageX - _this.offset.x;\r\n                    _this.window_info.width = _this.$el.outerWidth();\r\n                    _this.window_info.height = _this.$el.outerHeight();\r\n                }\r\n                if (_this.options.resizable && _this.resizing) {\r\n                    if (_this.$el.hasClass(\"east\")) {\r\n                        _this.$el.css('width', event.pageX - _this.window_info.left);\r\n                    }\r\n                    if (_this.$el.hasClass(\"west\")) {\r\n\r\n                        _this.$el.css('left', event.pageX);\r\n                        _this.$el.css('width', _this.window_info.width + (_this.window_info.left - event.pageX));\r\n                    }\r\n                    if (_this.$el.hasClass(\"south\")) {\r\n                        _this.$el.css('height', event.pageY - _this.window_info.top);\r\n                    }\r\n                    if (_this.$el.hasClass(\"north\")) {\r\n                        _this.$el.css('top', event.pageY);\r\n                        _this.$el.css('height', _this.window_info.height + (_this.window_info.top - event.pageY));\r\n                    }\r\n                }\r\n            });\r\n\r\n            this.$el.on('mousemove', function(event) {\r\n                if (_this.options.blocker) {\r\n                    return;\r\n                }\r\n                if (_this.options.resizable) {\r\n                    if (event.offsetY > (_this.$el.height() - 5) || event.offsetY < 5) {\r\n                        _this.$el.addClass('ns-resize');\r\n                    } else {\r\n                        _this.$el.removeClass('ns-resize');\r\n                    }\r\n                    if (event.offsetX > (_this.$el.width() - 5) || event.offsetX < 5) {\r\n                        _this.$el.addClass('ew-resize');\r\n\r\n                    } else {\r\n                        _this.$el.removeClass('ew-resize');\r\n                    }\r\n                }\r\n\r\n            });\r\n            */\r\n        },\r\n\r\n        resize : function(options) {\r\n            options = options || {};\r\n            if (options.top) {\r\n                this.$el.css('top', options.top);\r\n            }\r\n            if (options.left) {\r\n                this.$el.css('left', options.left);\r\n            }\r\n            if (options.height) {\r\n                this.$el.css('height', options.height);\r\n            }\r\n            if (options.width) {\r\n                this.$el.css('width', options.width);\r\n            }\r\n            this.$el.trigger(namespace + '.resize');\r\n        },\r\n\r\n        setBlocker : function(window_handle) {\r\n            this.options.blocker = window_handle;\r\n            this.$el.find('.disable-shade').remove();\r\n            var shade = '<div class=\"disable-shade\"></div>';\r\n            this.options.elements.body.append(shade);\r\n            this.options.elements.body.addClass('disable-scroll');\r\n            this.options.elements.footer.append(shade);\r\n            if (this.options.effect === 'fade') {\r\n                this.$el.find('.disable-shade').fadeIn();\r\n            } else {\r\n                this.$el.find('.disable-shade').show();\r\n            }\r\n\r\n            if (!this.options.blocker.getParent()) {\r\n                this.options.blocker.setParent(this);\r\n            }\r\n        },\r\n\r\n\r\n        getBlocker : function() {\r\n            return this.options.blocker;\r\n        },\r\n\r\n        clearBlocker : function() {\r\n            this.options.elements.body.removeClass('disable-scroll');\r\n            if (this.options.effect === 'fade') {\r\n                this.$el.find('.disable-shade').fadeOut(function() {\r\n                    this.remove();\r\n                });\r\n            } else {\r\n                this.$el.find('.disable-shade').hide();\r\n                this.remove();\r\n            }\r\n\r\n            delete this.options.blocker;\r\n        },\r\n\r\n        setParent : function(window_handle) {\r\n            this.options.parent = window_handle;\r\n            if (!this.options.parent.getBlocker()) {\r\n                this.options.parent.setBlocker(this);\r\n            }\r\n        },\r\n\r\n        getParent : function() {\r\n            return this.options.parent;\r\n        },\r\n\r\n        blink : function() {\r\n            var _this = this,\r\n                active = this.$el.hasClass('active'),\r\n\r\n                windowTab = this.getWindowTab(),\r\n                focused = windowTab ? windowTab.hasClass('label-primary') : undefined,\r\n\r\n                blinkInterval = setInterval(function() {\r\n                    _this.$el.toggleClass('active');\r\n                    if (windowTab) {\r\n                        windowTab.toggleClass('label-primary');\r\n                    }\r\n\r\n                }, 250),\r\n                blinkTimeout = setTimeout(function() {\r\n                    clearInterval(blinkInterval);\r\n                    if (active) {\r\n                        _this.$el.addClass('active');\r\n                    }\r\n                    if (windowTab && focused) {\r\n                        windowTab.addClass('label-primary');\r\n                    }\r\n\r\n                }, 1000);\r\n        }\r\n\r\n    });\r\n\r\n\r\n    datax.window = function(elm,options) {\r\n      var wgt  = this.data(elm,'sbswt.window');\r\n\r\n      if (!wgt) {\r\n        this.data(elm,'sbswt.window', (wgt = new Window(elm)));\r\n      }\r\n      if (typeof option == 'string') {\r\n        wgt[options]();\r\n      } \r\n   };\r\n\r\n\r\n    $('[data-window-target]').off('click');\r\n    $('[data-window-target]').on('click', function() {\r\n        var $this = $(this),\r\n            opts = {\r\n                selectors: {}\r\n            };\r\n        if ($this.data('windowTitle')) {\r\n            opts.title = $this.data('windowTitle');\r\n        }\r\n\r\n        if ($this.data('titleHandle')) {\r\n            opts.selectors.title = $this.data('titleHandle');\r\n        }\r\n\r\n        if ($this.data('windowHandle')) {\r\n            opts.selectors.handle = $this.data('windowHandle');\r\n        }\r\n        if ($this.data('clone')) {\r\n            opts.clone = $this.data('windowHandle');\r\n        }\r\n\r\n        $($this.data('windowTarget')).window(opts);\r\n    });\r\n\r\n\r\n\r\n    plugins.register(Window);\r\n\r\n    return windows.Window = Window;\r\n});"]}